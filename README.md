# Парсер
## Описание
### Краткое описание проекта
Парсер для сбора детальной информации о товарах с сайта https://alkoteka.com/
Выполнен в качестве тестового задания на вакансию python junior разработчик
### Описание кода
В результате реверс-инжиниринга сайта я обнаружил API, к которому выполняются запросы для получения информации о товарах.
В файле `alko_spider.py` создан паук, который делает запросы к API и получает ответы в формате json, что является очень удобным форматом для парсинга.
Паук логирует ту информацию, которую не удалось получить, выводя информацию в логи с ссылкой на товар.
Настройки проекта сделаны щадащими для избежания блокировки по количеству запросов в секунду.

## Стек технологий
![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54)
![Scrapy](https://img.shields.io/badge/scrapy-%2360a839.svg?style=for-the-badge&logo=scrapy&logoColor=d1d2d3)

## Результаты парсера

Результаты парсинга лежат в директории `results` в файле `results.json`

## Развернуть проект
Клонировать репозиторий и перейти в него в командной строке:
```
git clone https://github.com/hellishlemonade/test_task_scrapy.git
```
```
cd test_task_scrapy
```
Cоздать и активировать виртуальное окружение:
```
python3 -m venv venv
```
```
source venv/bin/activate
```

Установить зависимости из файла requirements.txt:
```
python3 -m pip install --upgrade pip
```
```
pip install -r requirements.txt
```
## Запуск парсера
Находясь в директории проекта выполнить команду (там где лежит файл `scrapy.cfg`):
```
scrapy crawl alko_spider
```
Парсер запуститься и создаст результирующий файл в директории `results`

## Техническое задание
Формат выходных данных для одного товара:
```
"timestamp": int,  # Дата и время сбора товара в формате timestamp.
"RPC": "str",  # Уникальный код товара.
"url": "str",  # Ссылка на страницу товара.
"title": "str",  # Заголовок/название товара (! Если в карточке товара указан цвет или объем, но их нет в названии, необходимо добавить их в title в формате: "{Название}, {Цвет или Объем}").
"marketing_tags": ["str"],  # Список маркетинговых тэгов, например: ['Популярный', 'Акция', 'Подарок']. Если тэг представлен в виде изображения собирать его не нужно.
"brand": "str",  # Бренд товара.
"section": ["str"],  # Иерархия разделов, например: ['Игрушки', 'Развивающие и интерактивные игрушки', 'Интерактивные игрушки'].
"price_data": {
    "current": float,  # Цена со скидкой, если скидки нет то = original.
    "original": float,  # Оригинальная цена.
    "sale_tag": "str"  # Если есть скидка на товар то необходимо вычислить процент скидки и записать формате: "Скидка {discount_percentage}%".
},
"stock": {
    "in_stock": bool,  # Есть товар в наличии в магазине или нет.
    "count": int  # Если есть возможность получить информацию о количестве оставшегося товара в наличии, иначе 0.
},
"assets": {
    "main_image": "str",  # Ссылка на основное изображение товара.
    "set_images": ["str"],  # Список ссылок на все изображения товара.
    "view360": ["str"],  # Список ссылок на изображения в формате 360.
    "video": ["str"]  # Список ссылок на видео/видеообложки товара.
},
"metadata": {
    "__description": "str",  # Описание товара
    "KEY": "str",
    "KEY": "str",
    "KEY": "str"
    # Также в metadata необходимо добавить все характеристики товара которые могут быть на странице.
    # Например: Артикул, Код товара, Цвет, Объем, Страна производитель и т.д.
    # Где KEY - наименование характеристики.
}
"variants": int,  # Кол-во вариантов у товара в карточке (За вариант считать только цвет или объем/масса. Размер у одежды или обуви варинтами не считаются).
}
```
